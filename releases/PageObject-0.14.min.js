/*
 * PageObject v0.14
 *
 * Copyright 2011, Mykhaylo Gavrylyuk, https://github.com/IronGroove
 * Licensed under the MIT license
 *
 * Date: Thu May 16 23:21:14 EEST 2013
 */

(function(e,t){"use strict";var n={};n.defaultOptions={container:undefined,containerClass:undefined,containerElement:"div",templateEngine:undefined,template:undefined,context:{},selectors:{},hide:false};if(e._&&t.isFunction(e._.template)){n.defaultOptions.templateEngine=e._.template}n.extractParts=function(e,r){var i={};if(!n.isElement(e)){throw"POE10: arguments should be 1st — HTML DOM container and 2nd — selectors map"}if(!t.isPlainObject(r)){r={}}t.each(r,function(r,s){var o,u=false;if(!/^[A-z\.]+$/.test(r)){throw"POE12: incorrect selector name `"+r+"`"}if(t.isArray(s)&&s.length===2&&t.type(s[0])==="string"&&t.isFunction(s[1])){i[r]={};t(e).find(s[0]).each(function(){var e=s[1].call(this,this);if(e){if(i[r][e]){throw"POE13: duplicate identifier `"+e+"` in DOM part namespace `"+r+"`"}i[r][e]=this}})}else if(t.isPlainObject(s)){i[r]=n.extractParts(e,s)}else if(typeof s==="string"){u=s.indexOf("[]")===0;if(u){s=s.replace("[]","")}o=t(e).find(s);if(o.length===0){throw"POE14: DOM parts weren't found for selector `"+r+"`"}else if(o.length>1){if(u){o=Array.prototype.slice.call(o)}else{throw"POE15: multiple DOM parts found for selector `"+r+"`"}}else{o=o[0]}i[r]=o}else{throw"POE16: invalid selector value"}});return i};n.isElement=function(t){return typeof e.HTMLElement==="object"?t instanceof e.HTMLElement:typeof t==="object"&&t!==null&&t.nodeType===1&&typeof t.nodeName==="string"};t.turnToPageObject=function(r,i){var s,o,u;if(t.type(r)!=="object"){throw"POE01: invalid target (1st argument should be an object)!"}if(!t.isPlainObject(i)){i={}}s=t.extend({},n.defaultOptions,i);if(!t.isPlainObject(r.DOM)){r.DOM={}}if(s.container!==undefined){if(!n.isElement(s.container)){throw"POE02: container is invalid!"}r.DOM.container=s.container}else{r.DOM.container=e.document.createElement(s.containerElement)}if(s.containerClass){t(r.DOM.container).addClass(s.containerClass)}if(s.template!==undefined){if(typeof s.template==="string"){if(!t.isFunction(s.templateEngine)){throw"POE03: templateEngine not configured"}}else if(typeof s.template!=="function"){throw"POE04: invalid template"}if(!t.isPlainObject(s.context)){s.context={}}try{if(typeof s.template==="string"){o=s.templateEngine(s.template,s.context)}else{o=s.template(s.context)}}catch(a){throw"POE20: template error: "+a}t(r.DOM.container).html(o)}if(!t.isPlainObject(s.selectors)){s.selectors={}}u=n.extractParts(r.DOM.container,s.selectors);t.extend(true,r.DOM,u);if(s.hide){t(r.DOM.container).hide()}return r};t.turnToPageObject.configure=function(e){if(t.isPlainObject(e)){t.extend(n.defaultOptions,e)}}})(window,jQuery);
